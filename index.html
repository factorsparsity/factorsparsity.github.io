<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline Video Player PWA</title>
    <!-- Link to the external manifest file -->
    <link rel="manifest" href="manifest.json">
    <!-- SLDS is typically loaded within the Salesforce platform, but for a standalone PWA, you would link to a CDN or a local copy -->
    <link rel="stylesheet" href="https://www.lightningdesignsystem.com/assets/styles/lightning-design-system.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        /* Overriding some default SLDS styles for better spacing in this standalone app */
        .slds-card {
            border: 1px solid var(--lwc-colorBorder, #dddbda);
            border-radius: var(--lwc-borderRadiusMedium, .25rem);
        }
    </style>
</head>
<body class="slds-p-around_medium slds-m-top_large">

    <div class="slds-card slds-p-around_large slds-max-small-size--1-of-1 slds-m-bottom_medium" style="max-width: 60rem; margin: auto;">
        <div class="slds-card__header slds-grid slds-p-bottom_medium">
            <h1 class="slds-text-heading_large slds-text-color_success">Offline Video Sync PWA</h1>
        </div>
        
        <!-- Status Message Box -->
        <div id="message-box" class="slds-notify slds-notify_alert slds-theme_alert-texture hidden" role="alert">
            <span class="slds-assistive-text">Info</span>
            <span class="slds-icon_container slds-icon-utility-info slds-m-right_x-small">
                <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                    <use xlink:href="https://www.lightningdesignsystem.com/assets/icons/utility-sprite/svg/symbols.svg#info"></use>
                </svg>
            </span>
            <p id="message-text"></p>
        </div>

        <!-- Video Player Section -->
        <div id="video-player-container" class="slds-p-around_medium hidden">
            <video id="video-player" controls class="slds-p-around_x-small" style="width: 100%;"></video>
        </div>

        <!-- Main Video List Section -->
        <div class="slds-grid slds-grid_vertical-align-center slds-m-vertical_medium">
            <h2 class="slds-text-heading_medium slds-m-right_large">Video List</h2>
            <div class="slds-button_group" role="group">
                <button id="sync-all-btn" class="slds-button slds-button_brand">
                    <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                        <use xlink:href="https://www.lightningdesignsystem.com/assets/icons/utility-sprite/svg/symbols.svg#sync"></use>
                    </svg>
                    Sync All Videos
                </button>
            </div>
        </div>

        <!-- Video Table -->
        <div class="slds-table_edit">
            <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="slds-text-title_caps" scope="col">Title</th>
                        <th class="slds-text-title_caps" scope="col">Link</th>
                        <th class="slds-text-title_caps" scope="col">Offline Status</th>
                        <th class="slds-text-title_caps" scope="col" style="text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody id="video-table-body">
                    <!-- Video rows will be inserted here by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- JavaScript for PWA Logic -->
    <script>
        // --- 1. MOCK VIDEO DATA & STATE MANAGEMENT ---
        const videoData = [{
            id: 'video-1',
            title: 'Introduction to PWAs',
            url: 'video1.mp4',
            isOffline: false
        }, {
            id: 'video-2',
            title: 'Service Worker Deep Dive',
            url: 'video2.mp4',
            isOffline: false
        }, {
            id: 'video-3',
            title: 'IndexedDB for Fun and Profit',
            url: 'video3.mp4',
            isOffline: false
        }];

        // --- 2. UI & EVENT HANDLING ---
        const videoTableBody = document.getElementById('video-table-body');
        const syncAllBtn = document.getElementById('sync-all-btn');
        const videoPlayerContainer = document.getElementById('video-player-container');
        const videoPlayer = document.getElementById('video-player');
        const messageBox = document.getElementById('message-box');

        const showMessage = (text, type = 'info') => {
            const messageText = document.getElementById('message-text');
            messageText.textContent = text;
            messageBox.classList.remove('hidden', 'slds-theme_success', 'slds-theme_error', 'slds-theme_info');
            messageBox.classList.add('slds-theme_alert-texture');

            if (type === 'success') {
                messageBox.classList.add('slds-theme_success');
                messageBox.querySelector('use').setAttribute('xlink:href'
